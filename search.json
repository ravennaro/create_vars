[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "featime",
    "section": "",
    "text": "from featime.featime import *\nimport pandas as pd\nimport random\nimport numpy as np\nimport matplotlib.pyplot as plt\npd.options.display.max_columns = None\nCriando variáveis numéricas e categóricas"
  },
  {
    "objectID": "index.html#install",
    "href": "index.html#install",
    "title": "featime",
    "section": "Install",
    "text": "Install\npip install featime"
  },
  {
    "objectID": "index.html#how-to-use",
    "href": "index.html#how-to-use",
    "title": "featime",
    "section": "How to use",
    "text": "How to use\n\nCriando dataframe aleatório\nCriando DataFrame com variáveis categóricas e numéricas\n\n# Criando o DataFrame\ndata = {\n    'ID_cliente': [random.choice(list(range(1, 101)))for _ in range(100)],\n    'data_transacao': [random.choice([202207, 202208, 202209, 202210, 202211, 202212, 202301, 202302, 202303, 202304, 202305,\n                                      202306, 202307, 202308]) for _ in range(100)],\n    'Feat_cat': [random.choice(['A', 'B', 'C']) for _ in range(100)],    \n    'Feat_num1': np.random.randint(0, 100, size=100),\n    'Feat_num2': np.random.randint(0, 100, size=100)\n}\ndf = pd.DataFrame(data)\n\n\ndf.head()\n\n\n\n\n\n\n\n\nID_cliente\ndata_transacao\nFeat_cat\nFeat_num1\nFeat_num2\n\n\n\n\n0\n43\n202211\nA\n50\n64\n\n\n1\n53\n202210\nB\n81\n1\n\n\n2\n30\n202307\nA\n47\n86\n\n\n3\n13\n202305\nB\n81\n21\n\n\n4\n41\n202207\nB\n56\n61\n\n\n\n\n\n\n\nO Dataframe criado tem o ID do cliente aleatório, podendo se repetir em datas diferentes,\n\ndf.groupby('ID_cliente')['data_transacao'].value_counts().sort_values(ascending=False)\n\nID_cliente  data_transacao\n64          202304            3\n26          202209            2\n92          202303            2\n1           202208            1\n66          202304            1\n                             ..\n36          202211            1\n35          202301            1\n30          202209            1\n            202307            1\n100         202306            1\nName: count, Length: 96, dtype: int64\n\n\n\n\nAjustando datas\nA variável data_transacao é a data que ocorreu algum tipo de transação na base. Para o nosso exemplo, teremos a seguinte distribuição das datas:\n\nplt.figure(figsize=(5,2))\ndf['data_transacao'].value_counts().sort_index().plot.bar(color = '#23238E')\n\n&lt;Axes: xlabel='data_transacao'&gt;\n\n\n\n\n\nAs datas suportadas precisam estar no formato YYYYMMDD. Por isso, vamos modificar a transação para o primeiro dia dos mês,\n\ndf['data_transacao'] = df['data_transacao'].apply(lambda x: str(x)+'01')\n\nPara criarmos variáveis em janelas, vamos criar uma data de referência chamada “safra_ref”. Ela também precisa estar no formato YYYYMMDD\n\ndf['safra_ref'] = '20230701'\n\n\n\nVariáveis numéricas\nA partir do ID_cliente do cliente e da data de transação, agrupamos as entradas e calculamos variáveis do tipo ‘sum’, ‘mean’ e ‘count’ que são fornecidas em forma de lista em ‘operations’ para variáveis numéricas. As variáveis utilizadas são listadas em ‘value_var’ e calculadas nas janelas de tempo em ‘window’ para a data de referência em ‘ref_time_var’.\n\nid_cols = ['ID_cliente','safra_ref']\ntrns_time = 'data_transacao'\nref_time = 'safra_ref'\nvalue_var = ['Feat_num1','Feat_num2']\nwindow = [-1,-2,-3,-6,-9,-12,-15]\noperations = ['sum','mean','count']\n\ndf_vars_num = featime_in_time(df,id_cols,trns_time,ref_time,value_var,window,operations)\n\n\ndf_vars_num.head()\n\n\n\n\n\n\n\n\nID_cliente\nsafra_ref\nFeat_num1_sum_1M\nFeat_num1_mean_1M\nFeat_num1_count_1M\nFeat_num1_sum_2M\nFeat_num1_mean_2M\nFeat_num1_count_2M\nFeat_num1_sum_3M\nFeat_num1_mean_3M\nFeat_num1_count_3M\nFeat_num1_sum_6M\nFeat_num1_mean_6M\nFeat_num1_count_6M\nFeat_num1_sum_9M\nFeat_num1_mean_9M\nFeat_num1_count_9M\nFeat_num1_sum_12M\nFeat_num1_mean_12M\nFeat_num1_count_12M\nFeat_num1_sum_15M\nFeat_num1_mean_15M\nFeat_num1_count_15M\nFeat_num2_sum_1M\nFeat_num2_mean_1M\nFeat_num2_count_1M\nFeat_num2_sum_2M\nFeat_num2_mean_2M\nFeat_num2_count_2M\nFeat_num2_sum_3M\nFeat_num2_mean_3M\nFeat_num2_count_3M\nFeat_num2_sum_6M\nFeat_num2_mean_6M\nFeat_num2_count_6M\nFeat_num2_sum_9M\nFeat_num2_mean_9M\nFeat_num2_count_9M\nFeat_num2_sum_12M\nFeat_num2_mean_12M\nFeat_num2_count_12M\nFeat_num2_sum_15M\nFeat_num2_mean_15M\nFeat_num2_count_15M\n\n\n\n\n0\n43\n2023-07-01\nNaN\nNaN\nNaN\nNaN\nNaN\nNaN\nNaN\nNaN\nNaN\n1.0\n1.0\n1.0\n123.0\n30.75\n4.0\n158.0\n31.6\n5.0\n158.0\n31.6\n5.0\nNaN\nNaN\nNaN\nNaN\nNaN\nNaN\nNaN\nNaN\nNaN\n92.0\n92.0\n1.0\n250.0\n62.5\n4.0\n305.0\n61.0\n5.0\n305.0\n61.0\n5.0\n\n\n1\n53\n2023-07-01\nNaN\nNaN\nNaN\nNaN\nNaN\nNaN\nNaN\nNaN\nNaN\nNaN\nNaN\nNaN\n81.0\n81.00\n1.0\n111.0\n55.5\n2.0\n111.0\n55.5\n2.0\nNaN\nNaN\nNaN\nNaN\nNaN\nNaN\nNaN\nNaN\nNaN\nNaN\nNaN\nNaN\n1.0\n1.0\n1.0\n97.0\n48.5\n2.0\n97.0\n48.5\n2.0\n\n\n2\n30\n2023-07-01\nNaN\nNaN\nNaN\nNaN\nNaN\nNaN\nNaN\nNaN\nNaN\nNaN\nNaN\nNaN\nNaN\nNaN\nNaN\n69.0\n34.5\n2.0\n69.0\n34.5\n2.0\nNaN\nNaN\nNaN\nNaN\nNaN\nNaN\nNaN\nNaN\nNaN\nNaN\nNaN\nNaN\nNaN\nNaN\nNaN\n82.0\n41.0\n2.0\n82.0\n41.0\n2.0\n\n\n3\n13\n2023-07-01\nNaN\nNaN\nNaN\n81.0\n81.0\n1.0\n81.0\n81.0\n1.0\n81.0\n81.0\n1.0\n142.0\n71.00\n2.0\n142.0\n71.0\n2.0\n142.0\n71.0\n2.0\nNaN\nNaN\nNaN\n21.0\n21.0\n1.0\n21.0\n21.0\n1.0\n21.0\n21.0\n1.0\n43.0\n21.5\n2.0\n43.0\n21.5\n2.0\n43.0\n21.5\n2.0\n\n\n4\n41\n2023-07-01\nNaN\nNaN\nNaN\nNaN\nNaN\nNaN\nNaN\nNaN\nNaN\n35.0\n35.0\n1.0\n35.0\n35.00\n1.0\n91.0\n45.5\n2.0\n91.0\n45.5\n2.0\nNaN\nNaN\nNaN\nNaN\nNaN\nNaN\nNaN\nNaN\nNaN\n43.0\n43.0\n1.0\n43.0\n43.0\n1.0\n104.0\n52.0\n2.0\n104.0\n52.0\n2.0\n\n\n\n\n\n\n\n\ndf[df['ID_cliente']==43]\n\n\n\n\n\n\n\n\nID_cliente\ndata_transacao\nFeat_cat\nFeat_num1\nFeat_num2\nsafra_ref\n\n\n\n\n0\n43\n20221101\nA\n50\n64\n20230701\n\n\n26\n43\n20221201\nC\n24\n63\n20230701\n\n\n63\n43\n20221001\nC\n48\n31\n20230701\n\n\n79\n43\n20220801\nC\n35\n55\n20230701\n\n\n81\n43\n20230101\nC\n1\n92\n20230701\n\n\n\n\n\n\n\n\n\nVariáveis categóricas\nPara variáveis categóricas, as operações são ‘nunique’ e mode.\n\nid_cols = ['ID_cliente','safra_ref']\ntrns_time = 'data_transacao'\nref_time = 'safra_ref'\nvalue_var = ['Feat_cat']\nwindow = [-1,-2,-3,-6,-9,-12,-15]\noperations = ['nunique', mode]\n\ndf_vars_cat = featime_in_time(df,id_cols,trns_time,ref_time,value_var,window,operations)\n\n\ndf_vars_cat.head()\n\n\n\n\n\n\n\n\nID_cliente\nsafra_ref\nFeat_cat_nunique_1M\nFeat_cat_mode_1M\nFeat_cat_nunique_2M\nFeat_cat_mode_2M\nFeat_cat_nunique_3M\nFeat_cat_mode_3M\nFeat_cat_nunique_6M\nFeat_cat_mode_6M\nFeat_cat_nunique_9M\nFeat_cat_mode_9M\nFeat_cat_nunique_12M\nFeat_cat_mode_12M\nFeat_cat_nunique_15M\nFeat_cat_mode_15M\n\n\n\n\n0\n43\n2023-07-01\nNaN\nNaN\nNaN\nNaN\nNaN\nNaN\n1.0\nC\n2.0\nC\n2.0\nC\n2.0\nC\n\n\n1\n53\n2023-07-01\nNaN\nNaN\nNaN\nNaN\nNaN\nNaN\nNaN\nNaN\n1.0\nB\n1.0\nB\n1.0\nB\n\n\n2\n30\n2023-07-01\nNaN\nNaN\nNaN\nNaN\nNaN\nNaN\nNaN\nNaN\nNaN\nNaN\n2.0\nB\n2.0\nB\n\n\n3\n13\n2023-07-01\nNaN\nNaN\n1.0\nB\n1.0\nB\n1.0\nB\n2.0\nA\n2.0\nA\n2.0\nA\n\n\n4\n41\n2023-07-01\nNaN\nNaN\nNaN\nNaN\nNaN\nNaN\n1.0\nC\n1.0\nC\n2.0\nB\n2.0\nB\n\n\n\n\n\n\n\n\ndf[df['ID_cliente']==43]\n\n\n\n\n\n\n\n\nID_cliente\ndata_transacao\nFeat_cat\nFeat_num1\nFeat_num2\nsafra_ref\n\n\n\n\n0\n43\n20221101\nA\n50\n64\n20230701\n\n\n26\n43\n20221201\nC\n24\n63\n20230701\n\n\n63\n43\n20221001\nC\n48\n31\n20230701\n\n\n79\n43\n20220801\nC\n35\n55\n20230701\n\n\n81\n43\n20230101\nC\n1\n92\n20230701"
  },
  {
    "objectID": "featime.html",
    "href": "featime.html",
    "title": "featime_in_time",
    "section": "",
    "text": "source\n\n\n\n mode (x)\n\nA função mode pode ser utilizada na criação de variáveis categóricas, ela representa a moda dos valores. Note que se existir mais de uma moda, por padrão a função retorna o primeiro valor em ordem alfabética.\nExemplo de utilização da função moda\n\nlista1 = pd.DataFrame({'coluna1': ['a', 'b', 'b', 'b', 'c']})\nmode(lista1['coluna1'])\n\n'b'\n\n\nExemplo de moda com dois valores\n\nlista1 = pd.DataFrame({'coluna1': ['b', 'b', 'a', 'a', 'c']})\nmode(lista1['coluna1'])\n\n'a'"
  },
  {
    "objectID": "featime.html#função-mode",
    "href": "featime.html#função-mode",
    "title": "featime_in_time",
    "section": "",
    "text": "source\n\n\n\n mode (x)\n\nA função mode pode ser utilizada na criação de variáveis categóricas, ela representa a moda dos valores. Note que se existir mais de uma moda, por padrão a função retorna o primeiro valor em ordem alfabética.\nExemplo de utilização da função moda\n\nlista1 = pd.DataFrame({'coluna1': ['a', 'b', 'b', 'b', 'c']})\nmode(lista1['coluna1'])\n\n'b'\n\n\nExemplo de moda com dois valores\n\nlista1 = pd.DataFrame({'coluna1': ['b', 'b', 'a', 'a', 'c']})\nmode(lista1['coluna1'])\n\n'a'"
  },
  {
    "objectID": "featime.html#criação-de-variáveis",
    "href": "featime.html#criação-de-variáveis",
    "title": "featime_in_time",
    "section": "Criação de variáveis",
    "text": "Criação de variáveis\n\nsource\n\nfeatime_in_time\n\n featime_in_time (df_, id_cols, trns_time_var:str, ref_time_var:str,\n                  value_vars:list, window:list, operations:list)\n\n\n\n\n\n\n\n\n\n\nType\nDetails\n\n\n\n\ndf_\n\nDataframe\n\n\nid_cols\n\nColunas de agrupamento como id e safra\n\n\ntrns_time_var\nstr\nData correspondente a variável\n\n\nref_time_var\nstr\nData que será a referência para calcular as janelas de tempo\n\n\nvalue_vars\nlist\nLista das variáveis que serão calculadas as operações\n\n\nwindow\nlist\nLista contendo a janela para calcular as variáveis\n\n\noperations\nlist\nLista das operações a serem calculadas\n\n\n\nFunção utilizada para criar as variáveis categóricas e numéricas."
  }
]